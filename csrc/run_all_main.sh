#!/bin/bash
M=(3584 4096 5120 7168 8192 9216 11008 12288 13824 14336 18944 20480 21504 27648 28672 32000 36864 49152)
K=(29568 4096 5120  8192  8192  5120 13824 20480  11008 5120 8192 3584  4096  14336 28672 4096 4096 3584 18944 7168 7168 7168 28672 9216 9216 9216 36864 12288 12288 12288 49152)
N=(8 16 32)
SPLIT_K=(7 7 3 3 4 5 5 7 7 3 7 7 7 7 7 7 3 6 7 1 3 4 3 7 5 2 5 2 6 3 6)
SPARSITY=(40 50 60 70)


for m in "${M[@]}"; do
    k=$m  # K与M相同
    n=$m  # 固定N值
    s=50  # 固定稀疏度
    sk=1  # 固定SPLIT_K值
    
    echo "Running spinfer and cublas test case: M=$m, K=$k, N=$n, S=$s, SK=$sk"
    ./spmm_test $m $k $n $s $sk
done